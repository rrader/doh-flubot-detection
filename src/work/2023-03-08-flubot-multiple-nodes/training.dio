<mxfile host="localhost" modified="2023-03-24T09:33:22.017Z" agent="5.0 (Macintosh)" etag="l3LH1MhUZFy_AzGBTQB5" version="20.5.3" type="embed"><diagram id="luUi05MAJug2sILlYeHl" name="Page-1"><mxGraphModel dx="1731" dy="1694" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" background="#ffffff" math="0" shadow="0"><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="27" value="Basic (Cacheable) processing" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;verticalAlign=top;shadow=1;" parent="1" vertex="1"><mxGeometry x="-50" y="460" width="498" height="440" as="geometry"/></mxCell><mxCell id="44" value="Preprocessing" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;verticalAlign=top;shadow=1;" parent="1" vertex="1"><mxGeometry x="209" y="1076" width="425" height="344" as="geometry"/></mxCell><mxCell id="31" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;exitX=0.5;exitY=0.917;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="98" target="26" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="360" y="280" as="sourcePoint"/></mxGeometry></mxCell><mxCell id="14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;" parent="1" source="12" target="13" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="12" value="read_csv" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="185" y="380" width="120" height="60" as="geometry"/></mxCell><mxCell id="13" value="&lt;div&gt;normalize packet directions&lt;/div&gt;&lt;div&gt;src -&amp;gt; dst&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="185" y="509" width="120" height="60" as="geometry"/></mxCell><mxCell id="24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;" parent="1" source="19" target="23" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="19" value="Packet lengths arrays parse, multiple directions" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="115" y="702" width="120" height="60" as="geometry"/></mxCell><mxCell id="25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;" parent="1" source="20" target="23" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="20" value="Inter-packet durations arrays parse, multiple directions" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="265" y="702" width="120" height="60" as="geometry"/></mxCell><mxCell id="69" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;" parent="1" source="23" target="67" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="23" value="Label data by Destination IP" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="185" y="830" width="120" height="60" as="geometry"/></mxCell><mxCell id="28" value="&lt;div&gt;no&lt;/div&gt;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;entryX=0.5;entryY=0;" parent="1" source="26" target="12" edge="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="245" y="345"/></Array></mxGeometry></mxCell><mxCell id="30" value="yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;" parent="1" source="26" target="29" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="26" value="feather file exists" style="shape=mxgraph.flowchart.decision;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2" parent="1" vertex="1"><mxGeometry x="320" y="305" width="80" height="80" as="geometry"/></mxCell><mxCell id="71" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" parent="1" source="29" target="59" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="29" value="read feather" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="470" y="431" width="120" height="60" as="geometry"/></mxCell><mxCell id="41" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;" parent="1" source="32" target="40" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="32" value="Packet lengths stats" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="290" y="1108" width="120" height="60" as="geometry"/></mxCell><mxCell id="42" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;" parent="1" source="33" target="40" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="33" value="Packet times stats" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="440" y="1108" width="120" height="60" as="geometry"/></mxCell><mxCell id="75" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;" parent="1" source="40" target="47" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="40" value="Remove empty records" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="360" y="1246" width="120" height="60" as="geometry"/></mxCell><mxCell id="54" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="47" target="52" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="420" y="1464" as="targetPoint"/></mxGeometry></mxCell><mxCell id="47" value="Normalize statistical fields" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="360" y="1340" width="120" height="60" as="geometry"/></mxCell><mxCell id="56" value="train dataset" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;" parent="1" source="52" target="55" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="52" value="Split train and test datasets" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="360.5" y="1460" width="120" height="60" as="geometry"/></mxCell><mxCell id="55" value="Build a model" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="360.5" y="1572" width="120" height="60" as="geometry"/></mxCell><mxCell id="61" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;" parent="1" source="59" target="32" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="62" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;" parent="1" source="59" target="33" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="59" value="Labeled dataframe" style="shape=mxgraph.flowchart.multi-document;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2" parent="1" vertex="1"><mxGeometry x="410" y="995" width="88" height="60" as="geometry"/></mxCell><mxCell id="70" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" parent="1" source="67" target="59" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="67" value="Save feather" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="185" y="906" width="120" height="60" as="geometry"/></mxCell><mxCell id="72" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0;entryY=0.5;jettySize=auto;orthogonalLoop=1;" parent="1" source="68" target="23" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="68" value="read DoH resolver IPs (prior knowledge)" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="-40" y="830" width="120" height="60" as="geometry"/></mxCell><mxCell id="77" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;" parent="1" source="13" target="76" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="78" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;" parent="1" source="76" target="19" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="79" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;" parent="1" source="76" target="20" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="76" value="&lt;div&gt;Filter by `Destination Port == 443` &lt;/div&gt;(only for model training)" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="185" y="600" width="120" height="60" as="geometry"/></mxCell><mxCell id="89" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;" parent="1" source="83" target="88" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="83" value="Basic (Cacheable) processing" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" parent="1" vertex="1"><mxGeometry x="-330" y="230" width="120" height="60" as="geometry"/></mxCell><mxCell id="85" value="&lt;div align=&quot;left&quot;&gt;Filter only HTTPS records, convert data types&lt;br&gt;&lt;/div&gt;" style="shape=mxgraph.flowchart.annotation_1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;shadow=0;" parent="1" vertex="1"><mxGeometry x="-200" y="215" width="80" height="79" as="geometry"/></mxCell><mxCell id="116" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="88" target="115"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="88" value="Preprocessing" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" parent="1" vertex="1"><mxGeometry x="-330" y="400" width="120" height="60" as="geometry"/></mxCell><mxCell id="96" value="Label data by Destination IP" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" parent="1" vertex="1"><mxGeometry x="-330" y="313" width="120" height="60" as="geometry"/></mxCell><mxCell id="97" value="&lt;div align=&quot;left&quot;&gt;Training data should be labeled&lt;/div&gt;" style="shape=mxgraph.flowchart.annotation_1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;shadow=0;align=left;" parent="1" vertex="1"><mxGeometry x="-200" y="309" width="80" height="79" as="geometry"/></mxCell><mxCell id="98" value="Capture" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;" parent="1" vertex="1"><mxGeometry x="300" y="215" width="120" height="60" as="geometry"/></mxCell><mxCell id="103" value="Capture" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;verticalAlign=top;shadow=1;" parent="1" vertex="1"><mxGeometry x="260.5" y="-180" width="220" height="280" as="geometry"/></mxCell><mxCell id="104" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;" parent="1" source="105" target="107" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="105" value="ipfixprobe on sandbox network edge" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="300.5" y="-150" width="120" height="60" as="geometry"/></mxCell><mxCell id="106" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;" parent="1" source="107" target="108" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="107" value="nemea/logger outside of sandbox network" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="300.5" y="-60" width="120" height="60" as="geometry"/></mxCell><mxCell id="108" value="csv" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="300.5" y="30" width="120" height="60" as="geometry"/></mxCell><mxCell id="109" value="&lt;div align=&quot;left&quot;&gt;plugins: pstats&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1"><mxGeometry x="370.5" y="-90" width="90" height="20" as="geometry"/></mxCell><mxCell id="111" value="Overview" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1"><mxGeometry x="-390" y="-10" width="60" height="30" as="geometry"/></mxCell><mxCell id="114" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="112" target="83"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="112" value="Sample and generate balanced training set" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1"><mxGeometry x="-330" y="120" width="120" height="60" as="geometry"/></mxCell><mxCell id="115" value="Train model" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1"><mxGeometry x="-330" y="501" width="120" height="60" as="geometry"/></mxCell><mxCell id="119" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;" edge="1" parent="1" source="120" target="124"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="120" value="Basic (Cacheable) processing" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1"><mxGeometry x="-520" y="232.5" width="120" height="60" as="geometry"/></mxCell><mxCell id="122" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="1" source="124" target="125"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="124" value="Preprocessing" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1"><mxGeometry x="-520" y="402.5" width="120" height="60" as="geometry"/></mxCell><mxCell id="125" value="Infer DoH column using the trained model" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1"><mxGeometry x="-520" y="503.5" width="120" height="60" as="geometry"/></mxCell><mxCell id="131" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="132" target="120"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="132" value="Capture traffic" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1"><mxGeometry x="-520" y="122.5" width="120" height="60" as="geometry"/></mxCell><mxCell id="135" value="Inference" style="text;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontStyle=1" vertex="1" parent="1"><mxGeometry x="-505" y="80" width="80" height="30" as="geometry"/></mxCell><mxCell id="136" value="Training" style="text;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontStyle=1" vertex="1" parent="1"><mxGeometry x="-305" y="80" width="70" height="30" as="geometry"/></mxCell><mxCell id="137" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="138" target="141"><mxGeometry relative="1" as="geometry"><mxPoint x="-359.9473684210525" y="846" as="targetPoint"/></mxGeometry></mxCell><mxCell id="138" value="Data prep (cacheble processing and preprocessing)" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;" vertex="1" parent="1"><mxGeometry x="-420" y="762" width="120" height="60" as="geometry"/></mxCell><mxCell id="146" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="141" target="145"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="141" value="Infer DoH/nonDoH" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1"><mxGeometry x="-420" y="850" width="120" height="60" as="geometry"/></mxCell><mxCell id="142" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="143" target="138"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="143" value="Capture traffic" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1"><mxGeometry x="-420" y="680" width="120" height="60" as="geometry"/></mxCell><mxCell id="148" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="145" target="147"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="145" value="Calculate ratio &lt;b&gt;ρ(a)&lt;br&gt;&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1"><mxGeometry x="-420" y="935" width="120" height="60" as="geometry"/></mxCell><mxCell id="147" value="Apply anomaly detection to flag infected machines" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1"><mxGeometry x="-420" y="1016" width="120" height="60" as="geometry"/></mxCell></root></mxGraphModel></diagram></mxfile>